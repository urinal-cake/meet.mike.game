{
  "version": 3,
  "sources": ["../../../scheduler-api-worker.js"],
  "sourceRoot": "D:\\Websites\\Personal Scheduler\\.wrangler\\tmp\\deploy-JIFWdM",
  "sourcesContent": ["/**\r\n * Cloudflare Worker for Scheduler API\r\n * Handles meeting availability and booking requests\r\n */\r\n\r\nexport default {\r\n  async fetch(request, env, ctx) {\r\n    const url = new URL(request.url);\r\n    const corsHeaders = {\r\n      'Access-Control-Allow-Origin': '*',\r\n      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\r\n      'Access-Control-Allow-Headers': 'Content-Type',\r\n    };\r\n\r\n    // Handle CORS\r\n    if (request.method === 'OPTIONS') {\r\n      return new Response(null, { headers: corsHeaders });\r\n    }\r\n\r\n    try {\r\n      if (url.pathname === '/api/availability' && request.method === 'GET') {\r\n        return handleAvailability(request, url, corsHeaders, env);\r\n      } else if (url.pathname === '/api/book' && request.method === 'POST') {\r\n        return handleBook(request, env, corsHeaders);\r\n      } else if (url.pathname === '/api/admin/approve' && request.method === 'POST') {\r\n        return handleApprove(request, env, corsHeaders);\r\n      } else if (url.pathname === '/api/admin/deny' && request.method === 'POST') {\r\n        return handleDeny(request, env, corsHeaders);\r\n      } else if (url.pathname === '/api/admin/request' && request.method === 'GET') {\r\n        return handleGetRequest(request, url, env, corsHeaders);\r\n      } else if (url.pathname === '/api/cancel' && request.method === 'POST') {\r\n        return handleCancel(request, env, corsHeaders);\r\n      } else if (url.pathname === '/api/booking' && request.method === 'GET') {\r\n        return handleGetBooking(request, url, env, corsHeaders);\r\n      } else {\r\n        return new Response('Not found', { status: 404, headers: corsHeaders });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      return new Response(JSON.stringify({ error: error.message }), {\r\n        status: 500,\r\n        headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n      });\r\n    }\r\n  },\r\n};\r\n\r\nconst MEETING_TYPES = {\r\n  'gdc-pleasant-talk': {\r\n    id: 'gdc-pleasant-talk',\r\n    title: 'Pleasant Talk',\r\n    durationMinutes: 40,\r\n    dateStart: new Date('2026-03-09'),\r\n    dateEnd: new Date('2026-03-13'),\r\n    dailyStart: 8.5,\r\n    dailyEnd: 17.5,\r\n  },\r\n  'gdc-quick-chat': {\r\n    id: 'gdc-quick-chat',\r\n    title: 'Quick Chat',\r\n    durationMinutes: 20,\r\n    dateStart: new Date('2026-03-09'),\r\n    dateEnd: new Date('2026-03-13'),\r\n    dailyStart: 8.5,\r\n    dailyEnd: 17.5,\r\n  },\r\n  'gdc-lunch': {\r\n    id: 'gdc-lunch',\r\n    title: 'Lunch',\r\n    durationMinutes: 60,\r\n    dateStart: new Date('2026-03-09'),\r\n    dateEnd: new Date('2026-03-13'),\r\n    dailyStart: 12,\r\n    dailyEnd: 13,\r\n  },\r\n  'gdc-dinner': {\r\n    id: 'gdc-dinner',\r\n    title: 'Dinner',\r\n    durationMinutes: 90,\r\n    dateStart: new Date('2026-03-09'),\r\n    dateEnd: new Date('2026-03-13'),\r\n    dailyStart: 18,\r\n    dailyEnd: 18.5,\r\n  },\r\n};\r\n\r\n/**\r\n * Get timezone offset string for ISO 8601 format\r\n */\r\nfunction getTimezoneOffset(timezone) {\r\n  // Map common timezones to their offsets\r\n  const tzOffsets = {\r\n    'America/Los_Angeles': '-08:00', // PST\r\n    'America/Denver': '-07:00',\r\n    'America/Chicago': '-06:00',\r\n    'America/New_York': '-05:00',\r\n    'UTC': '+00:00',\r\n  };\r\n  return tzOffsets[timezone] || '-08:00'; // Default to PST\r\n}\r\n\r\n// ===== Google Calendar Integration =====\r\n\r\n/**\r\n * Get OAuth 2.0 token for Google Calendar API using Service Account\r\n */\r\nasync function getGoogleAccessToken(env) {\r\n  if (!env.GOOGLE_SERVICE_ACCOUNT_JSON) {\r\n    throw new Error('GOOGLE_SERVICE_ACCOUNT_JSON not configured');\r\n  }\r\n\r\n  const serviceAccount = JSON.parse(env.GOOGLE_SERVICE_ACCOUNT_JSON);\r\n  const now = Math.floor(Date.now() / 1000);\r\n  const expiry = now + 3600;\r\n\r\n  // Create JWT header and claim set\r\n  const header = {\r\n    alg: 'RS256',\r\n    typ: 'JWT',\r\n  };\r\n\r\n  const claimSet = {\r\n    iss: serviceAccount.client_email,\r\n    scope: 'https://www.googleapis.com/auth/calendar',\r\n    aud: 'https://oauth2.googleapis.com/token',\r\n    iat: now,\r\n    exp: expiry,\r\n  };\r\n\r\n  // Encode header and claim set\r\n  const encodedHeader = base64UrlEncode(JSON.stringify(header));\r\n  const encodedClaimSet = base64UrlEncode(JSON.stringify(claimSet));\r\n  const signatureInput = `${encodedHeader}.${encodedClaimSet}`;\r\n\r\n  // Sign with private key\r\n  const signature = await signJWT(signatureInput, serviceAccount.private_key);\r\n  const jwt = `${signatureInput}.${signature}`;\r\n\r\n  // Exchange JWT for access token\r\n  const tokenResponse = await fetch('https://oauth2.googleapis.com/token', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\r\n    body: new URLSearchParams({\r\n      grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',\r\n      assertion: jwt,\r\n    }),\r\n  });\r\n\r\n  if (!tokenResponse.ok) {\r\n    const error = await tokenResponse.text();\r\n    throw new Error(`Failed to get access token: ${error}`);\r\n  }\r\n\r\n  const tokenData = await tokenResponse.json();\r\n  return tokenData.access_token;\r\n}\r\n\r\n/**\r\n * Sign JWT with RSA-SHA256\r\n */\r\nasync function signJWT(data, privateKeyPem) {\r\n  // Parse PEM private key\r\n  const pemContents = privateKeyPem\r\n    .replace(/-----BEGIN PRIVATE KEY-----/, '')\r\n    .replace(/-----END PRIVATE KEY-----/, '')\r\n    .replace(/\\s/g, '');\r\n\r\n  const binaryDer = Uint8Array.from(atob(pemContents), c => c.charCodeAt(0));\r\n\r\n  // Import key for signing\r\n  const key = await crypto.subtle.importKey(\r\n    'pkcs8',\r\n    binaryDer,\r\n    {\r\n      name: 'RSASSA-PKCS1-v1_5',\r\n      hash: 'SHA-256',\r\n    },\r\n    false,\r\n    ['sign']\r\n  );\r\n\r\n  // Sign the data\r\n  const encoder = new TextEncoder();\r\n  const signature = await crypto.subtle.sign(\r\n    'RSASSA-PKCS1-v1_5',\r\n    key,\r\n    encoder.encode(data)\r\n  );\r\n\r\n  return base64UrlEncode(signature);\r\n}\r\n\r\n/**\r\n * Base64 URL encode\r\n */\r\nfunction base64UrlEncode(data) {\r\n  let base64;\r\n  if (typeof data === 'string') {\r\n    base64 = btoa(data);\r\n  } else if (data instanceof ArrayBuffer) {\r\n    const bytes = new Uint8Array(data);\r\n    let binary = '';\r\n    for (let i = 0; i < bytes.length; i++) {\r\n      binary += String.fromCharCode(bytes[i]);\r\n    }\r\n    base64 = btoa(binary);\r\n  } else {\r\n    throw new Error('Unsupported data type for base64 encoding');\r\n  }\r\n\r\n  return base64\r\n    .replace(/\\+/g, '-')\r\n    .replace(/\\//g, '_')\r\n    .replace(/=/g, '');\r\n}\r\n\r\n/**\r\n * Get calendar events for a specific date\r\n */\r\nasync function getCalendarEvents(dateStr, env) {\r\n  if (!env.GOOGLE_CALENDAR_ID) {\r\n    console.warn('GOOGLE_CALENDAR_ID not configured, skipping calendar check');\r\n    return [];\r\n  }\r\n\r\n  try {\r\n    const accessToken = await getGoogleAccessToken(env);\r\n    const calendarId = env.GOOGLE_CALENDAR_ID;\r\n\r\n    const timeZone = env.TIME_ZONE || 'America/Los_Angeles';\r\n\r\n    // Set time range for the entire day using timezone-aware conversion\r\n    const startOfDay = getUtcDateForLocal(dateStr, '00:00:00', timeZone);\r\n    const endOfDay = getUtcDateForLocal(dateStr, '23:59:59', timeZone);\r\n\r\n    const url = new URL(\r\n      `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(\r\n        calendarId\r\n      )}/events`\r\n    );\r\n    url.searchParams.set('timeMin', startOfDay.toISOString());\r\n    url.searchParams.set('timeMax', endOfDay.toISOString());\r\n    url.searchParams.set('singleEvents', 'true');\r\n    url.searchParams.set('orderBy', 'startTime');\r\n\r\n    const response = await fetch(url.toString(), {\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.text();\r\n      throw new Error(`Calendar API error: ${error}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.items || [];\r\n  } catch (error) {\r\n    console.error('Error fetching calendar events:', error);\r\n    // Return empty array to gracefully degrade if calendar unavailable\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * Get local date parts and minutes for a given Date in a specific timezone\r\n */\r\nfunction getLocalDateParts(date, timeZone) {\r\n  const parts = new Intl.DateTimeFormat('en-CA', {\r\n    timeZone,\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    hour12: false,\r\n  }).formatToParts(date);\r\n\r\n  const get = (type) => parts.find(p => p.type === type).value;\r\n  const year = get('year');\r\n  const month = get('month');\r\n  const day = get('day');\r\n  const hour = parseInt(get('hour'), 10);\r\n  const minute = parseInt(get('minute'), 10);\r\n\r\n  return {\r\n    dateStr: `${year}-${month}-${day}`,\r\n    minutes: hour * 60 + minute,\r\n  };\r\n}\r\n\r\n/**\r\n * Get timezone offset in minutes for a given UTC Date\r\n */\r\nfunction getTimeZoneOffsetMinutes(utcDate, timeZone) {\r\n  const parts = new Intl.DateTimeFormat('en-CA', {\r\n    timeZone,\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit',\r\n    hour12: false,\r\n  }).formatToParts(utcDate);\r\n\r\n  const get = (type) => parts.find(p => p.type === type).value;\r\n  const localAsUtc = Date.UTC(\r\n    parseInt(get('year'), 10),\r\n    parseInt(get('month'), 10) - 1,\r\n    parseInt(get('day'), 10),\r\n    parseInt(get('hour'), 10),\r\n    parseInt(get('minute'), 10),\r\n    parseInt(get('second'), 10)\r\n  );\r\n\r\n  return (localAsUtc - utcDate.getTime()) / 60000;\r\n}\r\n\r\n/**\r\n * Convert local date/time to a UTC Date using timezone rules\r\n */\r\nfunction getUtcDateForLocal(dateStr, timeStr, timeZone) {\r\n  const [year, month, day] = dateStr.split('-').map(Number);\r\n  const [hour, minute, second = 0] = timeStr.split(':').map(Number);\r\n\r\n  let utcDate = new Date(Date.UTC(year, month - 1, day, hour, minute, second));\r\n  const offsetMinutes = getTimeZoneOffsetMinutes(utcDate, timeZone);\r\n  utcDate = new Date(utcDate.getTime() - offsetMinutes * 60000);\r\n  return utcDate;\r\n}\r\n\r\n/**\r\n * Get calendar busy intervals in local minutes for a specific date\r\n */\r\nasync function getCalendarBusyIntervals(dateStr, env) {\r\n  const timeZone = env.TIME_ZONE || 'America/Los_Angeles';\r\n\r\n  if (!env.GOOGLE_CALENDAR_ID) {\r\n    console.warn('GOOGLE_CALENDAR_ID not configured, skipping calendar check');\r\n    return [];\r\n  }\r\n\r\n  try {\r\n    const accessToken = await getGoogleAccessToken(env);\r\n    const calendarId = env.GOOGLE_CALENDAR_ID;\r\n\r\n    const timeMin = getUtcDateForLocal(dateStr, '00:00:00', timeZone).toISOString();\r\n    const timeMax = getUtcDateForLocal(dateStr, '23:59:59', timeZone).toISOString();\r\n\r\n    const response = await fetch('https://www.googleapis.com/calendar/v3/freeBusy', {\r\n      method: 'POST',\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        timeMin,\r\n        timeMax,\r\n        timeZone,\r\n        items: [{ id: calendarId }],\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.text();\r\n      throw new Error(`FreeBusy API error: ${error}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    const busy = (data.calendars && data.calendars[calendarId] && data.calendars[calendarId].busy) || [];\r\n\r\n    const intervals = [];\r\n    for (const block of busy) {\r\n      const blockStart = new Date(block.start);\r\n      const blockEnd = new Date(block.end);\r\n\r\n      const startParts = getLocalDateParts(blockStart, timeZone);\r\n      const endParts = getLocalDateParts(blockEnd, timeZone);\r\n\r\n      if (startParts.dateStr > dateStr || endParts.dateStr < dateStr) {\r\n        continue;\r\n      }\r\n\r\n      let startMinutes = startParts.minutes;\r\n      let endMinutes = endParts.minutes;\r\n\r\n      if (startParts.dateStr < dateStr) {\r\n        startMinutes = 0;\r\n      }\r\n\r\n      if (endParts.dateStr > dateStr) {\r\n        endMinutes = 24 * 60;\r\n      }\r\n\r\n      intervals.push({ startMinutes, endMinutes });\r\n    }\r\n\r\n    return intervals;\r\n  } catch (error) {\r\n    console.error('Error fetching free/busy:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * Create a calendar event for an approved booking\r\n */\r\nasync function createCalendarEvent(booking, env) {\r\n  if (!env.GOOGLE_CALENDAR_ID) {\r\n    console.warn('GOOGLE_CALENDAR_ID not configured, skipping calendar event creation');\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    const accessToken = await getGoogleAccessToken(env);\r\n    const calendarId = env.GOOGLE_CALENDAR_ID;\r\n\r\n    // Parse the date and time properly with timezone\r\n    const timezone = booking.timezone || 'America/Los_Angeles';\r\n    const startDateTime = `${booking.date}T${booking.time}:00`;\r\n    \r\n    // Calculate end time\r\n    const [hours, minutes] = booking.time.split(':').map(Number);\r\n    const totalMinutes = hours * 60 + minutes + booking.durationMinutes;\r\n    const endHours = Math.floor(totalMinutes / 60);\r\n    const endMinutes = totalMinutes % 60;\r\n    const endTime = `${String(endHours).padStart(2, '0')}:${String(endMinutes).padStart(2, '0')}`;\r\n    const endDateTime = `${booking.date}T${endTime}:00`;\r\n\r\n    console.log('Creating calendar event:', {\r\n      startDateTime,\r\n      endDateTime,\r\n      timezone,\r\n      calendarId\r\n    });\r\n\r\n    // Build detailed description\r\n    let descriptionParts = [\r\n      `ATTENDEE INFORMATION`,\r\n      `Name: ${booking.name}`,\r\n      `Email: ${booking.email}`,\r\n    ];\r\n\r\n    if (booking.company) {\r\n      descriptionParts.push(`Company: ${booking.company}`);\r\n    }\r\n\r\n    if (booking.role) {\r\n      descriptionParts.push(`Role: ${booking.role}`);\r\n    }\r\n\r\n    if (booking.location) {\r\n      descriptionParts.push('');\r\n      descriptionParts.push('LOCATION');\r\n      descriptionParts.push(booking.location);\r\n    }\r\n\r\n    if (booking.discussionTopics && booking.discussionTopics.length > 0) {\r\n      descriptionParts.push('');\r\n      descriptionParts.push('DISCUSSION TOPICS');\r\n      booking.discussionTopics.forEach(topic => {\r\n        descriptionParts.push(`\u2022 ${topic}`);\r\n      });\r\n    }\r\n\r\n    if (booking.discussionDetails) {\r\n      descriptionParts.push('');\r\n      descriptionParts.push('DETAILS & NOTES');\r\n      descriptionParts.push(booking.discussionDetails);\r\n    }\r\n\r\n    const description = descriptionParts.join('\\n');\r\n\r\n    // Create event object\r\n    const event = {\r\n      summary: `${booking.meetingTypeTitle} - ${booking.name}`,\r\n      description: description,\r\n      location: booking.location || '',\r\n      start: {\r\n        dateTime: startDateTime,\r\n        timeZone: timezone,\r\n      },\r\n      end: {\r\n        dateTime: endDateTime,\r\n        timeZone: timezone,\r\n      },\r\n      // Note: Not adding attendees because service accounts need Domain-Wide Delegation to invite\r\n      // The attendee gets a separate .ics file via email\r\n      reminders: {\r\n        useDefault: false,\r\n        overrides: [\r\n          { method: 'email', minutes: 24 * 60 },\r\n          { method: 'popup', minutes: 30 },\r\n        ],\r\n      },\r\n    };\r\n\r\n    const response = await fetch(\r\n      `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(\r\n        calendarId\r\n      )}/events`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${accessToken}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(event),\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      const error = await response.text();\r\n      console.error('Calendar API error response:', error);\r\n      throw new Error(`Failed to create calendar event: ${error}`);\r\n    }\r\n\r\n    const createdEvent = await response.json();\r\n    console.log('Calendar event created successfully:', createdEvent.id, createdEvent.htmlLink);\r\n    return createdEvent;\r\n  } catch (error) {\r\n    console.error('Error creating calendar event:', error);\r\n    console.error('Booking details:', {\r\n      date: booking.date,\r\n      time: booking.time,\r\n      timezone: booking.timezone,\r\n      duration: booking.durationMinutes\r\n    });\r\n    return null;\r\n  }\r\n}\r\n\r\n// ===== End Google Calendar Integration =====\r\n\r\nfunction getMeetingType(id) {\r\n  const mt = MEETING_TYPES[id];\r\n  if (!mt) return null;\r\n  return { ...mt };\r\n}\r\n\r\nfunction getMeetingTypes() {\r\n  return Object.values(MEETING_TYPES).map(mt => ({\r\n    id: mt.id,\r\n    title: mt.title,\r\n    durationMinutes: mt.durationMinutes,\r\n  }));\r\n}\r\n\r\nfunction dateInRange(date, startDate, endDate) {\r\n  return date >= startDate && date <= endDate;\r\n}\r\n\r\nfunction parseTimeToMinutes(timeStr) {\r\n  const [hour, minute] = timeStr.split(':').map(Number);\r\n  return hour * 60 + minute;\r\n}\r\n\r\nfunction minutesToTime(minutes) {\r\n  const hour = Math.floor(minutes / 60);\r\n  const minute = minutes % 60;\r\n  return `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\r\n}\r\n\r\nfunction overlapsBlockedRangeMinutes(startMinutes, endMinutes, meetingType) {\r\n  // Lunch buffer: 11:45-13:15 for non-lunch meetings\r\n  if (meetingType.id !== 'gdc-lunch') {\r\n    const blockedStart = 11 * 60 + 45;\r\n    const blockedEnd = 13 * 60 + 15;\r\n    return timesOverlapMinutes(startMinutes, endMinutes, blockedStart, blockedEnd);\r\n  }\r\n  return false;\r\n}\r\n\r\n// Check if two time ranges overlap (in minutes)\r\nfunction timesOverlapMinutes(start1, end1, start2, end2) {\r\n  return start1 < end2 && end1 > start2;\r\n}\r\n\r\n// Check if a proposed slot conflicts with existing busy intervals\r\nfunction hasConflictWithIntervals(slotStartMinutes, slotEndMinutes, intervals) {\r\n  for (const interval of intervals) {\r\n    if (timesOverlapMinutes(slotStartMinutes, slotEndMinutes, interval.startMinutes, interval.endMinutes)) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction isWithinDailyWindow(startTime, endTime, meetingType) {\r\n  const startHour = startTime.getHours();\r\n  const startMinutes = startTime.getMinutes();\r\n  const endHour = endTime.getHours();\r\n  const endMinutes = endTime.getMinutes();\r\n\r\n  const startDecimal = startHour + startMinutes / 60;\r\n  const endDecimal = endHour + endMinutes / 60;\r\n\r\n  return (\r\n    startDecimal >= meetingType.dailyStart &&\r\n    endDecimal <= meetingType.dailyEnd\r\n  );\r\n}\r\n\r\nasync function getAvailableSlots(dateStr, meetingTypeId, env) {\r\n  const meetingType = getMeetingType(meetingTypeId);\r\n  if (!meetingType) return [];\r\n\r\n  const date = new Date(dateStr + 'T00:00:00');\r\n  const slots = [];\r\n\r\n  if (!dateInRange(date, meetingType.dateStart, meetingType.dateEnd)) {\r\n    return slots;\r\n  }\r\n\r\n  const busyIntervals = await getCalendarBusyIntervals(dateStr, env);\r\n\r\n  const slotIntervalMinutes = 10;\r\n  const meetingDuration = meetingType.durationMinutes;\r\n\r\n  const dayStartMinutes = meetingType.dailyStart * 60;\r\n  const dayEndMinutes = meetingType.dailyEnd * 60;\r\n\r\n  for (let currentMinutes = dayStartMinutes; currentMinutes <= dayEndMinutes; currentMinutes += slotIntervalMinutes) {\r\n    const slotEndMinutes = currentMinutes + meetingDuration;\r\n\r\n    const available =\r\n      slotEndMinutes <= dayEndMinutes + meetingDuration &&\r\n      !overlapsBlockedRangeMinutes(currentMinutes, slotEndMinutes, meetingType) &&\r\n      !hasConflictWithIntervals(currentMinutes, slotEndMinutes, busyIntervals);\r\n\r\n    slots.push({\r\n      time: minutesToTime(currentMinutes),\r\n      available: available,\r\n    });\r\n  }\r\n\r\n  return slots;\r\n}\r\n\r\nasync function handleAvailability(request, url, corsHeaders, env) {\r\n  const date = url.searchParams.get('date');\r\n  const meetingTypeId = url.searchParams.get('meeting_type');\r\n\r\n  if (!date || !meetingTypeId) {\r\n    return new Response(\r\n      JSON.stringify({\r\n        error: 'Missing required parameters: date, meeting_type',\r\n      }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  const slots = await getAvailableSlots(date, meetingTypeId, env);\r\n\r\n  return new Response(JSON.stringify(slots), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\nasync function handleBook(request, env, corsHeaders) {\r\n  const body = await request.json();\r\n  const {\r\n    name,\r\n    email,\r\n    company,\r\n    role,\r\n    date,\r\n    time,\r\n    timezone,\r\n    meeting_type_id,\r\n    discussion_topics,\r\n    discussion_details,\r\n    location,\r\n  } = body;\r\n\r\n  // Validate required fields\r\n  if (!name || !email || !date || !time || !meeting_type_id || !discussion_details || !location) {\r\n    return new Response(JSON.stringify({ error: 'Missing required fields' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  const meetingType = getMeetingType(meeting_type_id);\r\n  if (!meetingType) {\r\n    return new Response(JSON.stringify({ error: 'Invalid meeting type' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Validate date and time\r\n  const dateObj = new Date(date + 'T00:00:00');\r\n  if (isNaN(dateObj.getTime())) {\r\n    return new Response(JSON.stringify({ error: 'Invalid date format' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (!/^\\d{2}:\\d{2}$/.test(time)) {\r\n    return new Response(JSON.stringify({ error: 'Invalid time format' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (!dateInRange(dateObj, meetingType.dateStart, meetingType.dateEnd)) {\r\n    return new Response(\r\n      JSON.stringify({ error: 'Selected date is not available for this meeting type' }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  const startMinutes = parseTimeToMinutes(time);\r\n  const endMinutes = startMinutes + meetingType.durationMinutes;\r\n  const dayStartMinutes = meetingType.dailyStart * 60;\r\n  const dayEndMinutes = meetingType.dailyEnd * 60;\r\n\r\n  if (startMinutes < dayStartMinutes || startMinutes > dayEndMinutes || endMinutes > dayEndMinutes + meetingType.durationMinutes) {\r\n    return new Response(\r\n      JSON.stringify({ error: 'Selected time is outside of available hours' }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  if (overlapsBlockedRangeMinutes(startMinutes, endMinutes, meetingType)) {\r\n    return new Response(\r\n      JSON.stringify({ error: 'Selected time overlaps a blocked period' }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  // Check for conflicts with existing bookings\r\n  const busyIntervals = await getCalendarBusyIntervals(date, env);\r\n  if (hasConflictWithIntervals(startMinutes, endMinutes, busyIntervals)) {\r\n    return new Response(\r\n      JSON.stringify({ error: 'Selected time conflicts with an existing booking' }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  // Generate request ID and token\r\n  const requestId = Date.now().toString(36) + Math.random().toString(36).substr(2);\r\n  const token = await generateToken();\r\n\r\n  // Store pending request in KV\r\n  const pendingRequest = {\r\n    id: requestId,\r\n    token: token,\r\n    name: name,\r\n    email: email,\r\n    company: company,\r\n    role: role,\r\n    meetingTypeId: meeting_type_id,\r\n    meetingTypeTitle: meetingType.title,\r\n    durationMinutes: meetingType.durationMinutes,\r\n    requestedDate: date,\r\n    requestedTime: time,\r\n    timezone: timezone || 'America/Los_Angeles',\r\n    location: location,\r\n    discussionTopics: discussion_topics || [],\r\n    discussionDetails: discussion_details,\r\n    status: 'pending',\r\n    createdAt: new Date().toISOString(),\r\n  };\r\n\r\n  // Store in KV (using email as part of key for easy lookup)\r\n  await env.SCHEDULER_KV.put(\r\n    `request:${requestId}`,\r\n    JSON.stringify(pendingRequest),\r\n    { expirationTtl: 7 * 24 * 60 * 60 } // 7 days\r\n  );\r\n\r\n  // Send admin notification\r\n  const baseURL = env.BASE_URL || 'https://meet.mike.game';\r\n  const reviewURL = `${baseURL}/admin/review?token=${token}`;\r\n\r\n  const emailWorkerURL = env.EMAIL_WORKER_URL;\r\n  if (emailWorkerURL) {\r\n    try {\r\n      await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'admin_notification',\r\n          reviewURL: reviewURL,\r\n          name: name,\r\n          email: email,\r\n          company: company,\r\n          role: role,\r\n          meetingType: meetingType.title,\r\n          duration: meetingType.durationMinutes,\r\n          date: date,\r\n          time: time,\r\n          timezone: timezone || 'America/Los_Angeles',\r\n          location: location,\r\n          topics: discussion_topics || [],\r\n          details: discussion_details,\r\n        }),\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to send admin notification:', err);\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ success: true, id: requestId }), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\nasync function generateToken() {\r\n  const array = new Uint8Array(32);\r\n  crypto.getRandomValues(array);\r\n  return Array.from(array, (byte) => byte.toString(16).padStart(2, '0')).join('');\r\n}\r\n\r\n// Get a pending request by token\r\nasync function handleGetRequest(request, url, env, corsHeaders) {\r\n  const token = url.searchParams.get('token');\r\n  if (!token) {\r\n    return new Response(JSON.stringify({ error: 'Missing token' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Find the request with this token\r\n  const listResult = await env.SCHEDULER_KV.list({ prefix: 'request:' });\r\n  for (const key of listResult.keys) {\r\n    const data = await env.SCHEDULER_KV.get(key.name);\r\n    if (data) {\r\n      const req = JSON.parse(data);\r\n      if (req.token === token) {\r\n        return new Response(JSON.stringify(req), {\r\n          headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ error: 'Request not found' }), {\r\n    status: 404,\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\n// Approve a booking request\r\nasync function handleApprove(request, env, corsHeaders) {\r\n  const body = await request.json();\r\n  const { token } = body;\r\n\r\n  if (!token) {\r\n    return new Response(JSON.stringify({ error: 'Missing token' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Find the request\r\n  const listResult = await env.SCHEDULER_KV.list({ prefix: 'request:' });\r\n  let pendingRequest = null;\r\n  let requestKey = null;\r\n\r\n  for (const key of listResult.keys) {\r\n    const data = await env.SCHEDULER_KV.get(key.name);\r\n    if (data) {\r\n      const req = JSON.parse(data);\r\n      if (req.token === token) {\r\n        pendingRequest = req;\r\n        requestKey = key.name;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!pendingRequest) {\r\n    return new Response(JSON.stringify({ error: 'Request not found' }), {\r\n      status: 404,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (pendingRequest.status !== 'pending') {\r\n    return new Response(\r\n      JSON.stringify({ error: `Request already ${pendingRequest.status}` }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  // Check for conflicts one more time before approving\r\n  const startMinutes = parseTimeToMinutes(pendingRequest.requestedTime);\r\n  const endMinutes = startMinutes + pendingRequest.durationMinutes;\r\n\r\n  const busyIntervals = await getCalendarBusyIntervals(pendingRequest.requestedDate, env);\r\n  if (hasConflictWithIntervals(startMinutes, endMinutes, busyIntervals)) {\r\n    return new Response(\r\n      JSON.stringify({ error: 'Time slot is no longer available due to a conflict' }),\r\n      { status: 409, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  // Create the approved booking\r\n  const cancellationToken = await generateToken();\r\n  const booking = {\r\n    id: pendingRequest.id,\r\n    cancellationToken: cancellationToken,\r\n    name: pendingRequest.name,\r\n    email: pendingRequest.email,\r\n    company: pendingRequest.company,\r\n    role: pendingRequest.role,\r\n    meetingTypeId: pendingRequest.meetingTypeId,\r\n    meetingTypeTitle: pendingRequest.meetingTypeTitle,\r\n    durationMinutes: pendingRequest.durationMinutes,\r\n    date: pendingRequest.requestedDate,\r\n    time: pendingRequest.requestedTime,\r\n    timezone: pendingRequest.timezone,\r\n    location: pendingRequest.location,\r\n    discussionTopics: pendingRequest.discussionTopics,\r\n    discussionDetails: pendingRequest.discussionDetails,\r\n    status: 'approved',\r\n    approvedAt: new Date().toISOString(),\r\n  };\r\n\r\n  // Create calendar event (this is now the source of truth)\r\n  const calendarEvent = await createCalendarEvent(booking, env);\r\n  if (calendarEvent) {\r\n    booking.calendarEventId = calendarEvent.id;\r\n    booking.calendarEventLink = calendarEvent.htmlLink;\r\n  }\r\n\r\n  // Store the approved booking in KV as backup/cache\r\n  await env.SCHEDULER_KV.put(\r\n    `booking:${booking.id}`,\r\n    JSON.stringify(booking),\r\n    { expirationTtl: 90 * 24 * 60 * 60 } // 90 days\r\n  );\r\n\r\n  // Update the request status\r\n  pendingRequest.status = 'approved';\r\n  await env.SCHEDULER_KV.put(requestKey, JSON.stringify(pendingRequest), {\r\n    expirationTtl: 7 * 24 * 60 * 60,\r\n  });\r\n\r\n  // Send emails\r\n  const emailWorkerURL = env.EMAIL_WORKER_URL;\r\n  if (emailWorkerURL) {\r\n    try {\r\n      // Calculate start and end times as ISO strings\r\n      // Parse date/time in the booking's timezone to avoid conversion issues\r\n      const [year, month, day] = booking.date.split('-').map(Number);\r\n      const [hours, minutes] = booking.time.split(':').map(Number);\r\n      \r\n      // Create date string in booking timezone format for correct ISO conversion\r\n      const tzOffset = getTimezoneOffset(booking.timezone);\r\n      const startDateTime = new Date(`${booking.date}T${booking.time}:00${tzOffset}`);\r\n      const endDateTime = new Date(startDateTime);\r\n      endDateTime.setMinutes(endDateTime.getMinutes() + booking.durationMinutes);\r\n\r\n      const baseURL = env.BASE_URL || 'https://meet.mike.game';\r\n      const cancellationURL = `${baseURL}/cancel?token=${cancellationToken}`;\r\n\r\n      // Send confirmation email to attendee\r\n      console.log('Sending approval email to attendee:', booking.email);\r\n      const attendeeEmailResponse = await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'approval',\r\n          to: booking.email,\r\n          appointmentId: booking.id,\r\n          name: booking.name,\r\n          email: booking.email,\r\n          company: booking.company,\r\n          role: booking.role,\r\n          meetingType: booking.meetingTypeTitle,\r\n          duration: booking.durationMinutes,\r\n          startTime: startDateTime.toISOString(),\r\n          endTime: endDateTime.toISOString(),\r\n          timezone: booking.timezone,\r\n          location: booking.location,\r\n          topics: booking.discussionTopics,\r\n          details: booking.discussionDetails,\r\n          cancellationURL: cancellationURL,\r\n        }),\r\n      });\r\n      const attendeeResult = await attendeeEmailResponse.json();\r\n      console.log('Attendee email response:', attendeeResult);\r\n\r\n      // Send notification to admin\r\n      console.log('Sending admin confirmation to:', env.GOOGLE_CALENDAR_ID);\r\n      const adminEmailResponse = await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'admin_confirmed',\r\n          to: env.GOOGLE_CALENDAR_ID,\r\n          appointmentId: booking.id,\r\n          name: booking.name,\r\n          email: booking.email,\r\n          company: booking.company,\r\n          role: booking.role,\r\n          meetingType: booking.meetingTypeTitle,\r\n          duration: booking.durationMinutes,\r\n          startTime: startDateTime.toISOString(),\r\n          endTime: endDateTime.toISOString(),\r\n          timezone: booking.timezone,\r\n          location: booking.location,\r\n          topics: booking.discussionTopics,\r\n          details: booking.discussionDetails,\r\n          calendarEventLink: calendarEvent ? calendarEvent.htmlLink : null,\r\n          cancellationURL: cancellationURL,\r\n        }),\r\n      });\r\n      const adminResult = await adminEmailResponse.json();\r\n      console.log('Admin email response:', adminResult);\r\n    } catch (err) {\r\n      console.error('Failed to send emails:', err);\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ success: true, booking }), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\n// Deny a booking request\r\nasync function handleDeny(request, env, corsHeaders) {\r\n  const body = await request.json();\r\n  const { token, reason } = body;\r\n\r\n  if (!token) {\r\n    return new Response(JSON.stringify({ error: 'Missing token' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Find the request\r\n  const listResult = await env.SCHEDULER_KV.list({ prefix: 'request:' });\r\n  let pendingRequest = null;\r\n  let requestKey = null;\r\n\r\n  for (const key of listResult.keys) {\r\n    const data = await env.SCHEDULER_KV.get(key.name);\r\n    if (data) {\r\n      const req = JSON.parse(data);\r\n      if (req.token === token) {\r\n        pendingRequest = req;\r\n        requestKey = key.name;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!pendingRequest) {\r\n    return new Response(JSON.stringify({ error: 'Request not found' }), {\r\n      status: 404,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (pendingRequest.status !== 'pending') {\r\n    return new Response(\r\n      JSON.stringify({ error: `Request already ${pendingRequest.status}` }),\r\n      { status: 400, headers: { 'Content-Type': 'application/json', ...corsHeaders } }\r\n    );\r\n  }\r\n\r\n  // Update the request status\r\n  pendingRequest.status = 'denied';\r\n  pendingRequest.deniedAt = new Date().toISOString();\r\n  pendingRequest.denialReason = reason;\r\n  await env.SCHEDULER_KV.put(requestKey, JSON.stringify(pendingRequest), {\r\n    expirationTtl: 7 * 24 * 60 * 60,\r\n  });\r\n\r\n  // Send denial email to user\r\n  const emailWorkerURL = env.EMAIL_WORKER_URL;\r\n  if (emailWorkerURL) {\r\n    try {\r\n      await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'denial',\r\n          to: pendingRequest.email,\r\n          name: pendingRequest.name,\r\n        }),\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to send denial email:', err);\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ success: true }), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\n// Get booking details by cancellation token\r\nasync function handleGetBooking(request, url, env, corsHeaders) {\r\n  const token = url.searchParams.get('token');\r\n  if (!token) {\r\n    return new Response(JSON.stringify({ error: 'Missing token' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Find the booking with this cancellation token\r\n  const listResult = await env.SCHEDULER_KV.list({ prefix: 'booking:' });\r\n  let booking = null;\r\n\r\n  for (const key of listResult.keys) {\r\n    const data = await env.SCHEDULER_KV.get(key.name);\r\n    if (data) {\r\n      const b = JSON.parse(data);\r\n      if (b.cancellationToken === token) {\r\n        booking = b;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!booking) {\r\n    return new Response(JSON.stringify({ error: 'Booking not found' }), {\r\n      status: 404,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (booking.status === 'cancelled') {\r\n    return new Response(JSON.stringify({ error: 'Booking already cancelled' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  return new Response(JSON.stringify(booking), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\n// Cancel a booking\r\nasync function handleCancel(request, env, corsHeaders) {\r\n  const body = await request.json();\r\n  const { token } = body;\r\n\r\n  if (!token) {\r\n    return new Response(JSON.stringify({ error: 'Missing token' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Find the booking with this cancellation token\r\n  const listResult = await env.SCHEDULER_KV.list({ prefix: 'booking:' });\r\n  let booking = null;\r\n  let bookingKey = null;\r\n\r\n  for (const key of listResult.keys) {\r\n    const data = await env.SCHEDULER_KV.get(key.name);\r\n    if (data) {\r\n      const b = JSON.parse(data);\r\n      if (b.cancellationToken === token) {\r\n        booking = b;\r\n        bookingKey = key.name;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!booking) {\r\n    return new Response(JSON.stringify({ error: 'Booking not found' }), {\r\n      status: 404,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  if (booking.status === 'cancelled') {\r\n    return new Response(JSON.stringify({ error: 'Booking already cancelled' }), {\r\n      status: 400,\r\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n    });\r\n  }\r\n\r\n  // Delete the calendar event if it exists\r\n  if (booking.calendarEventId) {\r\n    try {\r\n      await deleteCalendarEvent(booking.calendarEventId, env);\r\n    } catch (error) {\r\n      console.error('Failed to delete calendar event:', error);\r\n      // Continue with cancellation even if calendar deletion fails\r\n    }\r\n  }\r\n\r\n  // Update booking status\r\n  booking.status = 'cancelled';\r\n  booking.cancelledAt = new Date().toISOString();\r\n  await env.SCHEDULER_KV.put(bookingKey, JSON.stringify(booking), {\r\n    expirationTtl: 30 * 24 * 60 * 60, // Keep for 30 days\r\n  });\r\n\r\n  // Send cancellation emails\r\n  const emailWorkerURL = env.EMAIL_WORKER_URL;\r\n  if (emailWorkerURL) {\r\n    try {\r\n      const startDateTime = new Date(`${booking.date}T${booking.time}`);\r\n\r\n      // Email to attendee\r\n      await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'cancellation',\r\n          to: booking.email,\r\n          name: booking.name,\r\n          meetingType: booking.meetingTypeTitle,\r\n          date: booking.date,\r\n          time: booking.time,\r\n          timezone: booking.timezone,\r\n        }),\r\n      });\r\n\r\n      // Email to admin\r\n      await fetch(emailWorkerURL, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          type: 'cancellation_admin',\r\n          to: env.GOOGLE_CALENDAR_ID,\r\n          name: booking.name,\r\n          email: booking.email,\r\n          meetingType: booking.meetingTypeTitle,\r\n          date: booking.date,\r\n          time: booking.time,\r\n          timezone: booking.timezone,\r\n        }),\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to send cancellation emails:', err);\r\n    }\r\n  }\r\n\r\n  return new Response(JSON.stringify({ success: true }), {\r\n    headers: { 'Content-Type': 'application/json', ...corsHeaders },\r\n  });\r\n}\r\n\r\n// Delete a calendar event\r\nasync function deleteCalendarEvent(eventId, env) {\r\n  if (!env.GOOGLE_CALENDAR_ID) {\r\n    console.warn('GOOGLE_CALENDAR_ID not configured');\r\n    return;\r\n  }\r\n\r\n  const accessToken = await getGoogleAccessToken(env);\r\n  const calendarId = env.GOOGLE_CALENDAR_ID;\r\n\r\n  const response = await fetch(\r\n    `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(\r\n      calendarId\r\n    )}/events/${encodeURIComponent(eventId)}`,\r\n    {\r\n      method: 'DELETE',\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n    }\r\n  );\r\n\r\n  if (!response.ok && response.status !== 404) {\r\n    const error = await response.text();\r\n    throw new Error(`Failed to delete calendar event: ${error}`);\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
